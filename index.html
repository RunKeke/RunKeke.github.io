<!DOCTYPE html>
<html>
<head>
    <title>Maison Connectée</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .sensor { margin: 20px; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"></script>
    <script>
        const mqttServer = "wss://264102e9ac51433ebbd21aaeb57014e9.s1.eu.hivemq.cloud:8884/mqtt";
        const mqttPort = 8884;

        const mqttUser = "keke12";
        const mqttPassword = "Kekette12";

        const client = new Paho.MQTT.Client(mqttServer, mqttPort, "clientId-" + parseInt(Math.random() * 100, 10));
        
        function onMessageArrived(message) {
            console.log("Message reçu: " + message.payloadString);
            document.getElementById("data").innerText = message.payloadString;
        }

        function onConnect() {
            console.log("Connecté au serveur MQTT");
            client.subscribe("home/temperature");
        }

        function onConnectionLost(responseObject) {
            if (responseObject.errorCode !== 0) {
                console.log("Connexion perdue: " + responseObject.errorMessage);
            }
        }

        client.onMessageArrived = onMessageArrived;
        client.onConnectionLost = onConnectionLost;

        client.connect({
            onSuccess: onConnect,
            onFailure: function(e) { console.log("Échec de la connexion: " + e.errorMessage); },
            userName: mqttUser,
            password: mqttPassword,
            useSSL: false
        });
    </script>
</head>
<body>
    <h1>Gestion de la Maison</h1>
    <div class="sensor">
        <h2>Température</h2>
        <p id="data">Aucune donnée reçue</p>
    </div>
</body>
</html>
